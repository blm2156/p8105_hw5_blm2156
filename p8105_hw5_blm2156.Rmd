---
title: "p8105_hw5_blm2156"
output: github_document
---
# Problem 1

```{r}
library(tidyverse)
library(patchwork)

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species)) %>%
  janitor::clean_names()

function1 = function(x) {
  
  if(is.numeric(x)) {
    replace_na(x, round(mean(x, na.rm = TRUE)))
  } else if (is.character(x)) {
    replace_na(x, "virginica")
  }
}

iris_final = map_df(iris_with_missing, function1)
iris_final
```

# Problem 2
```{r}
problem2_files = list.files("./data/", full.names = TRUE)

p2_data = problem2_files %>%
  map(read_csv) %>%
  reduce(rbind)

tidy_p2 = p2_data %>%
  mutate(
    subject_id = c(1:10, 1:10),
    study_arm = c(rep("control", 10), rep("experiment", 10))
  ) %>%
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "values"
  ) %>%
  separate(week, into = c("week_name", "week_number"), sep = "_") %>%
  select(-week_name)
tidy_p2
  
```
## Spaghetti Plot

```{r}

```

